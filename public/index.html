<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Battle Mobile</title>
<style>
body { margin:0; overflow:hidden; background:#111; }
#ui {
  position:fixed; bottom:20px; width:100%;
  display:flex; justify-content:space-between;
  padding:20px;
}
.btn {
  width:70px; height:70px; border-radius:50%;
  background:#ffffff22; border:2px solid white;
  color:white; font-size:20px;
}
#shoot { background:#ff444488; }
</style>
</head>
<body>

<canvas id="game"></canvas>

<div id="ui">
  <div>
    <button class="btn" id="left">â—€</button>
    <button class="btn" id="right">â–¶</button>
  </div>
  <button class="btn" id="shoot">ðŸ”«</button>
</div>

<script src="/socket.io/socket.io.js"></script>
<script>
const socket = io();
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

let players = {};
let myId = null;

socket.on("players", data => { players = data; });
socket.on("newPlayer", p => players[p.id] = p);
socket.on("playerMoved", p => players[p.id] = p);
socket.on("playerLeft", id => delete players[id]);

function draw() {
  ctx.clearRect(0,0,canvas.width,canvas.height);
  for (let id in players) {
    let p = players[id];
    ctx.fillStyle = id === myId ? "lime" : "red";
    ctx.fillRect(p.x, p.y, 30, 30);
  }
  requestAnimationFrame(draw);
}
draw();

function move(dx) {
  socket.emit("move", { dx });
}

document.getElementById("left").ontouchstart = () => move(-5);
document.getElementById("right").ontouchstart = () => move(5);
document.getElementById("shoot").ontouchstart = () => socket.emit("shoot");
</script>

</body>
</html>
